<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EmbedAI SDK - åŸºç¡€ç¤ºä¾‹</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .demo-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background: #f8f9fa;
        }
        
        .demo-section h3 {
            margin-top: 0;
            color: #495057;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            background: #007bff;
            color: white;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
        }
        
        button:hover {
            background: #0056b3;
        }
        
        button:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        
        .status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .status.connected {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.disconnected {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .config-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .config-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        label {
            font-weight: 500;
            color: #495057;
        }
        
        input, select {
            padding: 8px 12px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 13px;
            overflow-x: auto;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¤– EmbedAI SDK åŸºç¡€ç¤ºä¾‹</h1>
        
        <div class="demo-section">
            <h3>ğŸ“‹ åŸºæœ¬é…ç½®</h3>
            <div class="config-section">
                <div class="config-group">
                    <label for="serverUrl">æœåŠ¡å™¨åœ°å€:</label>
                    <input type="text" id="serverUrl" value="http://localhost:8000" />
                </div>
                <div class="config-group">
                    <label for="knowledgeBaseId">çŸ¥è¯†åº“ID:</label>
                    <input type="number" id="knowledgeBaseId" value="1" />
                </div>
                <div class="config-group">
                    <label for="clientId">å®¢æˆ·ç«¯ID:</label>
                    <input type="text" id="clientId" value="demo-client-123" />
                </div>
                <div class="config-group">
                    <label for="thirdPartyUserId">ç”¨æˆ·ID:</label>
                    <input type="number" id="thirdPartyUserId" value="1001" />
                </div>
            </div>
            
            <div class="button-group" style="margin-top: 20px;">
                <button onclick="initializeSDK()">åˆå§‹åŒ– SDK</button>
                <button onclick="destroySDK()">é”€æ¯ SDK</button>
            </div>
            
            <div id="initStatus" class="status" style="display: none;"></div>
        </div>
        
        <div class="demo-section">
            <h3>ğŸ® æ§åˆ¶æ“ä½œ</h3>
            <div class="button-group">
                <button onclick="openChat()" id="openBtn" disabled>æ‰“å¼€èŠå¤©</button>
                <button onclick="closeChat()" id="closeBtn" disabled>å…³é—­èŠå¤©</button>
                <button onclick="minimizeChat()" id="minimizeBtn" disabled>æœ€å°åŒ–</button>
                <button onclick="clearChat()" id="clearBtn" disabled>æ¸…ç©ºèŠå¤©</button>
            </div>
        </div>
        
        <div class="demo-section">
            <h3>ğŸ¨ ä¸»é¢˜é…ç½®</h3>
            <div class="config-section">
                <div class="config-group">
                    <label for="primaryColor">ä¸»è‰²è°ƒ:</label>
                    <input type="color" id="primaryColor" value="#007bff" onchange="updateTheme()" />
                </div>
                <div class="config-group">
                    <label for="position">ä½ç½®:</label>
                    <select id="position" onchange="updatePosition()">
                        <option value="bottom-right">å³ä¸‹è§’</option>
                        <option value="bottom-left">å·¦ä¸‹è§’</option>
                        <option value="top-right">å³ä¸Šè§’</option>
                        <option value="top-left">å·¦ä¸Šè§’</option>
                    </select>
                </div>
                <div class="config-group">
                    <label for="autoOpen">è‡ªåŠ¨æ‰“å¼€:</label>
                    <input type="checkbox" id="autoOpen" onchange="updateAutoOpen()" />
                </div>
            </div>
        </div>
        
        <div class="demo-section">
            <h3>ğŸ“Š çŠ¶æ€ä¿¡æ¯</h3>
            <div id="statusInfo">
                <p><strong>è¿æ¥çŠ¶æ€:</strong> <span id="connectionStatus">æœªè¿æ¥</span></p>
                <p><strong>å½“å‰èŠå¤©:</strong> <span id="currentChat">æ— </span></p>
                <p><strong>SDKç‰ˆæœ¬:</strong> <span id="sdkVersion">-</span></p>
            </div>
        </div>
        
        <div class="demo-section">
            <h3>ğŸ’» ä»£ç ç¤ºä¾‹</h3>
            <div class="code-block" id="codeExample">
// åŸºç¡€ä½¿ç”¨ç¤ºä¾‹
const embedai = new EmbedAI({
  serverUrl: 'http://localhost:8000',
  knowledgeBaseId: 1,
  clientId: 'your-client-id',
  thirdPartyUserId: 1001,
  theme: {
    primaryColor: '#007bff'
  },
  position: {
    horizontal: 'right',
    vertical: 'bottom'
  }
});

// åˆå§‹åŒ–
await embedai.init();

// äº‹ä»¶ç›‘å¬
embedai.on('open', () => console.log('èŠå¤©çª—å£å·²æ‰“å¼€'));
embedai.on('message', (message) => console.log('æ”¶åˆ°æ¶ˆæ¯:', message));
            </div>
        </div>
    </div>

    <!-- å¼•å…¥ EmbedAI SDK -->
    <script src="../dist/embedai.min.js"></script>
    
    <script>
        let embedaiInstance = null;
        
        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStatus() {
            const connectionStatus = document.getElementById('connectionStatus');
            const currentChat = document.getElementById('currentChat');
            const sdkVersion = document.getElementById('sdkVersion');
            
            if (embedaiInstance) {
                connectionStatus.textContent = embedaiInstance.getConnectionStatus();
                const chat = embedaiInstance.getCurrentChat();
                currentChat.textContent = chat ? `ID: ${chat.id}` : 'æ— ';
                sdkVersion.textContent = EmbedAI.getVersion();
            } else {
                connectionStatus.textContent = 'æœªè¿æ¥';
                currentChat.textContent = 'æ— ';
                sdkVersion.textContent = '-';
            }
        }
        
        // æ›´æ–°æŒ‰é’®çŠ¶æ€
        function updateButtons(enabled) {
            const buttons = ['openBtn', 'closeBtn', 'minimizeBtn', 'clearBtn'];
            buttons.forEach(id => {
                document.getElementById(id).disabled = !enabled;
            });
        }
        
        // åˆå§‹åŒ–SDK
        async function initializeSDK() {
            try {
                const config = {
                    serverUrl: document.getElementById('serverUrl').value,
                    knowledgeBaseId: parseInt(document.getElementById('knowledgeBaseId').value),
                    clientId: document.getElementById('clientId').value,
                    thirdPartyUserId: parseInt(document.getElementById('thirdPartyUserId').value),
                    autoOpen: document.getElementById('autoOpen').checked,
                    theme: {
                        primaryColor: document.getElementById('primaryColor').value
                    }
                };
                
                // è§£æä½ç½®é…ç½®
                const position = document.getElementById('position').value;
                const [vertical, horizontal] = position.split('-');
                config.position = { horizontal, vertical };
                
                // é”€æ¯ç°æœ‰å®ä¾‹
                if (embedaiInstance) {
                    embedaiInstance.destroy();
                }
                
                // åˆ›å»ºæ–°å®ä¾‹
                embedaiInstance = new EmbedAI(config);
                
                // æ·»åŠ äº‹ä»¶ç›‘å¬
                embedaiInstance.on('open', () => {
                    console.log('èŠå¤©çª—å£å·²æ‰“å¼€');
                    updateStatus();
                });
                
                embedaiInstance.on('close', () => {
                    console.log('èŠå¤©çª—å£å·²å…³é—­');
                    updateStatus();
                });
                
                embedaiInstance.on('message', (message) => {
                    console.log('æ”¶åˆ°æ¶ˆæ¯:', message);
                });
                
                // åˆå§‹åŒ–
                await embedaiInstance.init();
                
                // æ›´æ–°çŠ¶æ€
                updateButtons(true);
                updateStatus();
                
                // æ˜¾ç¤ºæˆåŠŸçŠ¶æ€
                const status = document.getElementById('initStatus');
                status.className = 'status connected';
                status.textContent = 'SDK åˆå§‹åŒ–æˆåŠŸï¼';
                status.style.display = 'block';
                
            } catch (error) {
                console.error('åˆå§‹åŒ–å¤±è´¥:', error);
                
                // æ˜¾ç¤ºé”™è¯¯çŠ¶æ€
                const status = document.getElementById('initStatus');
                status.className = 'status disconnected';
                status.textContent = `åˆå§‹åŒ–å¤±è´¥: ${error.message}`;
                status.style.display = 'block';
            }
        }
        
        // é”€æ¯SDK
        function destroySDK() {
            if (embedaiInstance) {
                embedaiInstance.destroy();
                embedaiInstance = null;
                updateButtons(false);
                updateStatus();
                
                const status = document.getElementById('initStatus');
                status.className = 'status disconnected';
                status.textContent = 'SDK å·²é”€æ¯';
                status.style.display = 'block';
            }
        }
        
        // æ§åˆ¶å‡½æ•°
        function openChat() {
            if (embedaiInstance) {
                embedaiInstance.open();
            }
        }
        
        function closeChat() {
            if (embedaiInstance) {
                embedaiInstance.close();
            }
        }
        
        function minimizeChat() {
            if (embedaiInstance) {
                embedaiInstance.minimize();
            }
        }
        
        function clearChat() {
            if (embedaiInstance) {
                embedaiInstance.clearChat();
            }
        }
        
        // æ›´æ–°ä¸»é¢˜
        function updateTheme() {
            if (embedaiInstance) {
                const primaryColor = document.getElementById('primaryColor').value;
                embedaiInstance.updateConfig({
                    theme: { primaryColor }
                });
            }
        }
        
        // æ›´æ–°ä½ç½®
        function updatePosition() {
            if (embedaiInstance) {
                const position = document.getElementById('position').value;
                const [vertical, horizontal] = position.split('-');
                embedaiInstance.updateConfig({
                    position: { horizontal, vertical }
                });
            }
        }
        
        // æ›´æ–°è‡ªåŠ¨æ‰“å¼€
        function updateAutoOpen() {
            if (embedaiInstance) {
                const autoOpen = document.getElementById('autoOpen').checked;
                embedaiInstance.updateConfig({ autoOpen });
            }
        }
        
        // åˆå§‹åŒ–çŠ¶æ€
        updateStatus();
        updateButtons(false);
    </script>
</body>
</html>
